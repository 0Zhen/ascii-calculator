<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    
    <!-- SEO Meta Tags -->
    <title>ASCII Êü•Ë°®Â∑•ÂÖ∑ - Á®ãÂºèË®≠Ë®à‰∫∫Âì°Ë®àÁÆóÊ©ü | ÈÄ≤Âà∂ËΩâÊèõÂô®</title>
    <meta name="description" content="ÂÖçË≤ªÁöÑ ASCII Á¢ºÊü•Ë©¢Â∑•ÂÖ∑ÔºåÊîØÊè¥ HEX„ÄÅDEC„ÄÅOCT„ÄÅBIN ÈÄ≤Âà∂ËΩâÊèõÔºå64-bit Ë®àÁÆóÊ©üÂäüËÉΩÔºåÁ®ãÂºèË®≠Ë®à‰∫∫Âì°ÂøÖÂÇôÂ∑•ÂÖ∑„ÄÇ">
    <meta name="keywords" content="ASCII, Êü•Ë°®, ÈÄ≤Âà∂ËΩâÊèõ, HEX, ÂçÅÂÖ≠ÈÄ≤‰Ωç, Ë®àÁÆóÊ©ü, Á®ãÂºèË®≠Ë®à, Â≠óÂÖÉÁ∑®Á¢º, ASCII table, programmer calculator">
    <meta name="author" content="Your Name">
    <meta name="robots" content="index, follow">
    <meta name="language" content="zh-TW">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://0Zhen.github.io/ascii-calculator/">
    <meta property="og:title" content="ASCII Êü•Ë°®Â∑•ÂÖ∑ - Á®ãÂºèË®≠Ë®à‰∫∫Âì°Ë®àÁÆóÊ©ü">
    <meta property="og:description" content="ÂÖçË≤ªÁöÑ ASCII Á¢ºÊü•Ë©¢Â∑•ÂÖ∑ÔºåÊîØÊè¥Â§öÁ®ÆÈÄ≤Âà∂ËΩâÊèõÂíåË®àÁÆóÂäüËÉΩ">
    <meta property="og:image" content="https://0Zhen.github.io/ascii-calculator/preview.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://0Zhen.github.io/ascii-calculator/">
    <meta property="twitter:title" content="ASCII Êü•Ë°®Â∑•ÂÖ∑ - Á®ãÂºèË®≠Ë®à‰∫∫Âì°Ë®àÁÆóÊ©ü">
    <meta property="twitter:description" content="ÂÖçË≤ªÁöÑ ASCII Á¢ºÊü•Ë©¢Â∑•ÂÖ∑ÔºåÊîØÊè¥Â§öÁ®ÆÈÄ≤Âà∂ËΩâÊèõÂíåË®àÁÆóÂäüËÉΩ">
    <meta property="twitter:image" content="https://0Zhen.github.io/ascii-calculator/preview.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://0Zhen.github.io/ascii-calculator/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üî§</text></svg>">
    
    <!-- Google Analytics (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YJVN3FYCEJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YJVN3FYCEJ');
    </script>
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ASCII Êü•Ë°®Â∑•ÂÖ∑",
        "description": "ÂÖçË≤ªÁöÑ ASCII Á¢ºÊü•Ë©¢Â∑•ÂÖ∑ÔºåÊîØÊè¥ HEX„ÄÅDEC„ÄÅOCT„ÄÅBIN ÈÄ≤Âà∂ËΩâÊèõ",
        "url": "https://0Zhen.github.io/ascii-calculator/",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "softwareVersion": "1.0",
        "author": {
            "@type": "Person",
            "name": "Your Name"
        }
    }
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #202020;
            color: #ffffff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            touch-action: manipulation;
        }

        .header {
            background: #1f1f1f;
            padding: 10px 15px;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-shrink: 0;
        }

        .menu-icon {
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
        }

        .title {
            font-size: 14px;
            font-weight: normal;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 15px;
            overflow: auto;
            min-height: 0;
        }

        .display-area {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .char-display {
            text-align: right;
            font-size: clamp(48px, 10vw, 72px);
            font-weight: 300;
            margin-bottom: 15px;
            min-height: clamp(60px, 12vw, 90px);
            font-family: 'Consolas', monospace;
            color: #ffffff;
            word-break: break-all;
        }

        .format-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 12px;
            border-bottom: 1px solid #404040;
            overflow-x: auto;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
        }

        .format-tabs::-webkit-scrollbar {
            height: 0;
        }

        .format-tab {
            flex: 1;
            min-width: 60px;
            padding: 10px 8px;
            background: transparent;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 12px;
            text-align: center;
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
            white-space: nowrap;
        }

        .format-tab.active {
            color: #60cdff;
            border-bottom: 2px solid #60cdff;
        }

        .format-tab:hover:not(.active) {
            background: #333;
        }

        .value-display {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            padding: 6px 10px;
        }

        .value-display.active .value-content {
            color: #60cdff;
            font-weight: 600;
        }

        .value-label {
            font-size: 11px;
            color: #999;
            width: 50px;
            flex-shrink: 0;
        }

        .value-display.active .value-label {
            color: #60cdff;
        }

        .value-content {
            font-size: clamp(16px, 4vw, 20px);
            font-family: 'Consolas', monospace;
            flex: 1;
            cursor: pointer;
            transition: color 0.2s;
            word-break: break-all;
            overflow-wrap: break-word;
        }

        .value-content:hover {
            color: #60cdff;
        }

        .keypad {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 4px;
            min-height: 0;
        }

        .key-btn {
            background: #3b3b3b;
            border: 1px solid #404040;
            color: #ffffff;
            font-size: clamp(14px, 3.5vw, 16px);
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.1s;
            font-family: 'Consolas', monospace;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 45px;
            touch-action: manipulation;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .key-btn:hover {
            background: #4a4a4a;
        }

        .key-btn:active {
            background: #333;
            transform: scale(0.95);
        }

        .key-btn.hex-letter {
            color: #60cdff;
        }

        .key-btn.operator {
            background: #2d2d2d;
        }

        .key-btn.special {
            font-size: clamp(12px, 3vw, 14px);
        }

        .key-btn.clear {
            background: #8b0000;
        }

        .key-btn.clear:hover {
            background: #a00000;
        }

        .key-btn.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .key-btn.disabled:hover {
            background: #3b3b3b;
        }

        .bottom-bar {
            background: #1f1f1f;
            padding: 10px 15px;
            border-top: 1px solid #333;
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .mode-btn {
            flex: 1;
            padding: 10px 8px;
            background: #2d2d2d;
            border: 1px solid #404040;
            color: #999;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s;
            font-size: clamp(11px, 2.5vw, 12px);
            white-space: nowrap;
            touch-action: manipulation;
            user-select: none;
        }

        .mode-btn.active {
            background: #3b3b3b;
            color: #60cdff;
            border-color: #60cdff;
        }

        .mode-btn:hover:not(.active) {
            background: #353535;
        }

        /* Âπ≥ÊùøË£ùÁΩÆ (768px ‰ª•‰∏ä) */
        @media (min-width: 768px) {
            .header {
                padding: 12px 20px;
            }

            .title {
                font-size: 16px;
            }

            .container {
                padding: 20px;
            }

            .display-area {
                padding: 20px;
                margin-bottom: 20px;
            }

            .char-display {
                margin-bottom: 20px;
            }

            .format-tabs {
                margin-bottom: 15px;
            }

            .format-tab {
                padding: 12px 10px;
                font-size: 13px;
                text-align: left;
                padding-left: 15px;
            }

            .value-display {
                gap: 15px;
                margin-bottom: 10px;
                padding: 8px 15px;
            }

            .value-label {
                font-size: 12px;
                width: 60px;
            }

            .keypad {
                gap: 5px;
            }

            .key-btn {
                min-height: 50px;
            }

            .bottom-bar {
                padding: 12px 20px;
                gap: 10px;
            }

            .mode-btn {
                padding: 12px 10px;
            }
        }

        /* Ê°åÈù¢Ë£ùÁΩÆ (1024px ‰ª•‰∏ä) */
        @media (min-width: 1024px) {
            .key-btn {
                min-height: 55px;
            }

            .keypad {
                max-height: 400px;
            }
        }

        /* Â∞èËû¢ÂπïË£ùÁΩÆ (ÊúÄÂ§ß 480px) */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .display-area {
                padding: 12px;
                margin-bottom: 10px;
            }

            .char-display {
                margin-bottom: 10px;
            }

            .format-tabs {
                margin-bottom: 10px;
            }

            .value-display {
                gap: 8px;
                margin-bottom: 6px;
                padding: 5px 8px;
            }

            .value-label {
                width: 45px;
            }

            .keypad {
                gap: 3px;
            }

            .key-btn {
                min-height: 40px;
            }

            .bottom-bar {
                padding: 8px 10px;
                gap: 5px;
            }

            .mode-btn {
                padding: 8px 5px;
            }
        }

        /* Ê©´ÂêëÊ®°ÂºèÂÑ™Âåñ */
        @media (max-height: 500px) and (orientation: landscape) {
            .container {
                padding: 10px;
            }

            .display-area {
                padding: 10px;
                margin-bottom: 8px;
            }

            .char-display {
                font-size: 36px;
                min-height: 45px;
                margin-bottom: 8px;
            }

            .format-tabs {
                margin-bottom: 8px;
            }

            .format-tab {
                padding: 6px 8px;
            }

            .value-display {
                margin-bottom: 5px;
                padding: 4px 8px;
            }

            .keypad {
                gap: 3px;
            }

            .key-btn {
                min-height: 35px;
                font-size: 13px;
            }

            .key-btn.special {
                font-size: 11px;
            }

            .bottom-bar {
                padding: 6px 10px;
            }

            .mode-btn {
                padding: 6px 5px;
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="menu-icon">‚ò∞</div>
        <div class="title">Á®ãÂºèË®≠Ë®à‰∫∫Âì°</div>
    </div>

    <div class="container">
        <div class="display-area">
            <div class="char-display" id="charDisplay">0</div>
            
            <div class="format-tabs">
                <button class="format-tab" data-format="char">CHAR</button>
                <button class="format-tab active" data-format="hex">HEX</button>
                <button class="format-tab" data-format="dec">DEC</button>
                <button class="format-tab" data-format="oct">OCT</button>
                <button class="format-tab" data-format="bin">BIN</button>
            </div>

            <div class="value-display" data-format="char">
                <span class="value-label">CHAR</span>
                <span class="value-content" id="charValue">NUL</span>
            </div>
            <div class="value-display active" data-format="hex">
                <span class="value-label">HEX</span>
                <span class="value-content" id="hexValue">0</span>
            </div>
            <div class="value-display" data-format="dec">
                <span class="value-label">DEC</span>
                <span class="value-content" id="decValue">0</span>
            </div>
            <div class="value-display" data-format="oct">
                <span class="value-label">OCT</span>
                <span class="value-content" id="octValue">0</span>
            </div>
            <div class="value-display" data-format="bin">
                <span class="value-label">BIN</span>
                <span class="value-content" id="binValue">0</span>
            </div>
        </div>

        <div class="keypad">
            <button class="key-btn operator" data-value="NOT">NOT</button>
            <button class="key-btn operator" data-value="OR">OR</button>
            <button class="key-btn special" data-value="‚å´">‚å´</button>
            <button class="key-btn operator" data-value="AND">AND</button>
            <button class="key-btn operator" data-value="/">√∑</button>

            <button class="key-btn hex-letter" data-value="A">A</button>
            <button class="key-btn hex-letter" data-value="B">B</button>
            <button class="key-btn" data-value="7">7</button>
            <button class="key-btn" data-value="8">8</button>
            <button class="key-btn" data-value="9">9</button>

            <button class="key-btn hex-letter" data-value="C">C</button>
            <button class="key-btn hex-letter" data-value="D">D</button>
            <button class="key-btn" data-value="4">4</button>
            <button class="key-btn" data-value="5">5</button>
            <button class="key-btn" data-value="6">6</button>

            <button class="key-btn hex-letter" data-value="E">E</button>
            <button class="key-btn hex-letter" data-value="F">F</button>
            <button class="key-btn" data-value="1">1</button>
            <button class="key-btn" data-value="2">2</button>
            <button class="key-btn" data-value="3">3</button>

            <button class="key-btn operator" data-value="<<">&lt;&lt;</button>
            <button class="key-btn operator" data-value=">>">&gt;&gt;</button>
            <button class="key-btn clear" data-value="AC">AC</button>
            <button class="key-btn" data-value="0">0</button>
            <button class="key-btn operator" data-value="=">=</button>

            <button class="key-btn operator" data-value="-">-</button>
            <button class="key-btn operator" data-value="+">+</button>
            <button class="key-btn operator" data-value="*">√ó</button>
        </div>
    </div>

    <div class="bottom-bar">
        <button class="mode-btn active">QWORD</button>
        <button class="mode-btn">DWORD</button>
        <button class="mode-btn">WORD</button>
        <button class="mode-btn">BYTE</button>
    </div>

    <script>
        let currentValue = 0n;
        let currentFormat = 'hex';
        let operator = null;
        let previousValue = null;
        let shouldResetOnNextInput = false;
        let maxBits = 64;
        let inputBuffer = '';

        const asciiTable = {
            0: 'NUL', 1: 'SOH', 2: 'STX', 3: 'ETX', 4: 'EOT', 5: 'ENQ', 6: 'ACK', 7: 'BEL',
            8: 'BS', 9: 'TAB', 10: 'LF', 11: 'VT', 12: 'FF', 13: 'CR', 14: 'SO', 15: 'SI',
            16: 'DLE', 17: 'DC1', 18: 'DC2', 19: 'DC3', 20: 'DC4', 21: 'NAK', 22: 'SYN', 23: 'ETB',
            24: 'CAN', 25: 'EM', 26: 'SUB', 27: 'ESC', 28: 'FS', 29: 'GS', 30: 'RS', 31: 'US',
            127: 'DEL'
        };

        function getMaxValue() {
            return (1n << BigInt(maxBits)) - 1n;
        }

        function updateDisplay(value) {
            currentValue = value;
            
            // Êõ¥Êñ∞‰∏ªÈ°ØÁ§∫
            if (currentFormat === 'char') {
                const num = Number(value);
                if (num >= 32 && num <= 126) {
                    document.getElementById('charDisplay').textContent = String.fromCharCode(num);
                } else {
                    document.getElementById('charDisplay').textContent = asciiTable[num] || 'ÔøΩ';
                }
            } else {
                document.getElementById('charDisplay').textContent = value.toString();
            }

            // Êõ¥Êñ∞ÊâÄÊúâÊ†ºÂºèÁöÑÊï∏ÂÄº
            const num = Number(value);
            
            // CHAR
            if (num >= 32 && num <= 126) {
                document.getElementById('charValue').textContent = String.fromCharCode(num);
            } else {
                document.getElementById('charValue').textContent = asciiTable[num] || 'ÔøΩ';
            }

            // HEX
            document.getElementById('hexValue').textContent = value.toString(16).toUpperCase();

            // DEC
            document.getElementById('decValue').textContent = value.toString(10);

            // OCT
            document.getElementById('octValue').textContent = value.toString(8);

            // BIN - Ê†πÊìö maxBits ÂãïÊÖãË™øÊï¥È°ØÁ§∫Èï∑Â∫¶
            const binStr = value.toString(2);
            const paddedBin = binStr.padStart(maxBits, '0');
            const formattedBin = paddedBin.match(/.{1,4}/g).join(' ');
            document.getElementById('binValue').textContent = formattedBin;

            updateValueHighlight();
        }

        function updateValueHighlight() {
            document.querySelectorAll('.value-display').forEach(display => {
                if (display.getAttribute('data-format') === currentFormat) {
                    display.classList.add('active');
                } else {
                    display.classList.remove('active');
                }
            });
        }

        function updateKeypadState() {
            document.querySelectorAll('.key-btn').forEach(btn => {
                const value = btn.getAttribute('data-value');
                let shouldDisable = false;

                if (currentFormat === 'char') {
                    // CHAR Ê®°Âºè‰∏ãÁ¶ÅÁî®ÊâÄÊúâÊåâÈçµ
                    shouldDisable = true;
                } else if (currentFormat === 'hex') {
                    shouldDisable = false;
                } else if (currentFormat === 'dec') {
                    shouldDisable = ['A','B','C','D','E','F','8','9'].includes(value);
                } else if (currentFormat === 'oct') {
                    shouldDisable = ['A','B','C','D','E','F','8','9'].includes(value);
                } else if (currentFormat === 'bin') {
                    shouldDisable = ['A','B','C','D','E','F','2','3','4','5','6','7','8','9'].includes(value);
                }

                if (shouldDisable) {
                    btn.classList.add('disabled');
                } else {
                    btn.classList.remove('disabled');
                }
            });
        }

        function calculate() {
            if (operator === null || previousValue === null) return;

            try {
                let result;
                switch (operator) {
                    case '+':
                        result = previousValue + currentValue;
                        break;
                    case '-':
                        result = previousValue - currentValue;
                        if (result < 0n) result = 0n;
                        break;
                    case '*':
                        result = previousValue * currentValue;
                        break;
                    case '/':
                        if (currentValue === 0n) {
                            alert('Èô§Êï∏‰∏çËÉΩÁÇ∫Èõ∂');
                            return;
                        }
                        result = previousValue / currentValue;
                        break;
                    case '%':
                        if (currentValue === 0n) {
                            alert('Èô§Êï∏‰∏çËÉΩÁÇ∫Èõ∂');
                            return;
                        }
                        result = previousValue % currentValue;
                        break;
                    case '<<':
                        result = previousValue << currentValue;
                        break;
                    case '>>':
                        result = previousValue >> currentValue;
                        break;
                    case 'AND':
                        result = previousValue & currentValue;
                        break;
                    case 'OR':
                        result = previousValue | currentValue;
                        break;
                    default:
                        return;
                }

                if (result > getMaxValue()) {
                    result = getMaxValue();
                }
                if (result < 0n) {
                    result = 0n;
                }

                updateDisplay(result);
                operator = null;
                previousValue = null;
                shouldResetOnNextInput = true;
            } catch (e) {
                console.error('Ë®àÁÆóÈåØË™§:', e);
            }
        }

        // Ê†ºÂºèÂàáÊèõ
        document.querySelectorAll('.format-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.format-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                currentFormat = tab.getAttribute('data-format');
                updateDisplay(currentValue);
                updateKeypadState();
                inputBuffer = '';
            });
        });

        // ÊåâÈçµÂäüËÉΩ
        document.querySelectorAll('.key-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (btn.classList.contains('disabled')) return;
                
                const value = btn.getAttribute('data-value');

                if (value === 'AC') {
                    // AC - Ê∏ÖÈô§ÂÖ®ÈÉ®ÔºàAll ClearÔºâ
                    inputBuffer = '';
                    updateDisplay(0n);
                    operator = null;
                    previousValue = null;
                    shouldResetOnNextInput = false;
                } else if (value === '‚å´') {
                    // ÈÄÄÊ†º
                    inputBuffer = inputBuffer.slice(0, -1);
                    if (inputBuffer === '') {
                        updateDisplay(0n);
                    } else {
                        try {
                            let newValue;
                            if (getBase() === 16) {
                                newValue = BigInt('0x' + inputBuffer);
                            } else {
                                newValue = BigInt(parseInt(inputBuffer, getBase()));
                            }
                            if (newValue <= getMaxValue()) {
                                updateDisplay(newValue);
                            }
                        } catch (e) {
                            updateDisplay(0n);
                        }
                    }
                } else if (value === 'NOT') {
                    // NOT - ‰ΩçÂÖÉÂèçËΩâÔºà‰∏ÄÂÖÉÈÅãÁÆóÔºâ
                    updateDisplay(getMaxValue() - currentValue);
                    inputBuffer = '';
                    shouldResetOnNextInput = true;
                } else if (['+', '-', '*', '/', '<<', '>>', 'AND', 'OR'].includes(value)) {
                    // ÈÅãÁÆóÁ¨¶
                    if (operator !== null && !shouldResetOnNextInput) {
                        calculate();
                    }
                    operator = value;
                    previousValue = currentValue;
                    shouldResetOnNextInput = true;
                    inputBuffer = '';
                } else if (value === '=') {
                    // Á≠âÊñº
                    calculate();
                    inputBuffer = '';
                } else if (['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'].includes(value)) {
                    // Êï∏Â≠óËº∏ÂÖ•
                    if (shouldResetOnNextInput) {
                        inputBuffer = '';
                        shouldResetOnNextInput = false;
                    }
                    
                    inputBuffer += value;
                    try {
                        let newValue;
                        if (getBase() === 16) {
                            newValue = BigInt('0x' + inputBuffer);
                        } else {
                            newValue = BigInt(parseInt(inputBuffer, getBase()));
                        }
                        
                        if (newValue <= getMaxValue()) {
                            updateDisplay(newValue);
                        } else {
                            inputBuffer = inputBuffer.slice(0, -1);
                        }
                    } catch (e) {
                        inputBuffer = inputBuffer.slice(0, -1);
                    }
                }
            });
        });

        function getBase() {
            switch (currentFormat) {
                case 'char': return 10;
                case 'hex': return 16;
                case 'dec': return 10;
                case 'oct': return 8;
                case 'bin': return 2;
                default: return 10;
            }
        }

        // ÈçµÁõ§Áõ£ËÅΩ
        document.addEventListener('keydown', (e) => {
            if (currentFormat === 'char') {
                if (e.key.length === 1) {
                    e.preventDefault();
                    const code = e.key.charCodeAt(0);
                    if (code >= 0 && code <= 127) {
                        updateDisplay(BigInt(code));
                    }
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    updateDisplay(13n);
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    updateDisplay(9n);
                } else if (e.key === 'Backspace') {
                    e.preventDefault();
                    updateDisplay(8n);
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    updateDisplay(27n);
                }
            } else {
                let keyValue = e.key.toUpperCase();
                let isValidKey = false;
                
                if (currentFormat === 'hex') {
                    isValidKey = /^[0-9A-F]$/.test(keyValue);
                } else if (currentFormat === 'dec') {
                    isValidKey = /^[0-9]$/.test(keyValue);
                } else if (currentFormat === 'oct') {
                    isValidKey = /^[0-7]$/.test(keyValue);
                } else if (currentFormat === 'bin') {
                    isValidKey = /^[0-1]$/.test(keyValue);
                }
                
                if (isValidKey) {
                    e.preventDefault();
                    if (shouldResetOnNextInput) {
                        inputBuffer = '';
                        shouldResetOnNextInput = false;
                    }
                    
                    inputBuffer += keyValue;
                    try {
                        let newValue;
                        if (getBase() === 16) {
                            newValue = BigInt('0x' + inputBuffer);
                        } else {
                            newValue = BigInt(parseInt(inputBuffer, getBase()));
                        }
                        
                        if (newValue <= getMaxValue()) {
                            updateDisplay(newValue);
                        } else {
                            inputBuffer = inputBuffer.slice(0, -1);
                        }
                    } catch (e) {
                        inputBuffer = inputBuffer.slice(0, -1);
                    }
                } else if (e.key === 'Backspace') {
                    e.preventDefault();
                    inputBuffer = inputBuffer.slice(0, -1);
                    if (inputBuffer === '') {
                        updateDisplay(0n);
                    } else {
                        try {
                            let newValue;
                            if (getBase() === 16) {
                                newValue = BigInt('0x' + inputBuffer);
                            } else {
                                newValue = BigInt(parseInt(inputBuffer, getBase()));
                            }
                            
                            if (newValue <= getMaxValue()) {
                                updateDisplay(newValue);
                            }
                        } catch (e) {
                            updateDisplay(0n);
                        }
                    }
                } else if (e.key === 'Escape' || e.key === 'c' || e.key === 'C') {
                    if (e.key === 'Escape' || e.ctrlKey) {
                        e.preventDefault();
                        inputBuffer = '';
                        updateDisplay(0n);
                        operator = null;
                        previousValue = null;
                        shouldResetOnNextInput = false;
                    }
                } else if (e.key === 'Enter' || e.key === '=') {
                    e.preventDefault();
                    calculate();
                    inputBuffer = '';
                } else if (['+', '-', '*', '/', '%'].includes(e.key)) {
                    e.preventDefault();
                    if (operator !== null && !shouldResetOnNextInput) {
                        calculate();
                    }
                    operator = e.key;
                    previousValue = currentValue;
                    shouldResetOnNextInput = true;
                    inputBuffer = '';
                }
            }
        });

        // ÈªûÊìäË§áË£ΩÂäüËÉΩ
        document.querySelectorAll('.value-content').forEach(elem => {
            elem.addEventListener('click', () => {
                const text = elem.textContent;
                navigator.clipboard.writeText(text).then(() => {
                    const original = elem.textContent;
                    elem.textContent = 'Â∑≤Ë§áË£Ω!';
                    setTimeout(() => {
                        elem.textContent = original;
                    }, 1000);
                });
            });
        });

        // Ê®°ÂºèÂàáÊèõ
        document.querySelectorAll('.mode-btn').forEach((btn, index) => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                switch (index) {
                    case 0: maxBits = 64; break;
                    case 1: maxBits = 32; break;
                    case 2: maxBits = 16; break;
                    case 3: maxBits = 8; break;
                }
                
                // Â¶ÇÊûúÁï∂ÂâçÂÄºË∂ÖÈÅéÊñ∞ÁöÑÊúÄÂ§ßÂÄºÔºåÂâáÊà™Êñ∑
                if (currentValue > getMaxValue()) {
                    updateDisplay(getMaxValue());
                } else {
                    // ÈáçÊñ∞Êõ¥Êñ∞È°ØÁ§∫‰ª•Ë™øÊï¥ BIN ÁöÑÈï∑Â∫¶
                    updateDisplay(currentValue);
                }
            });
        });

        // ÂàùÂßãÂåñ
        updateDisplay(0n);
        updateKeypadState();
        updateValueHighlight();
    </script>
</body>
</html>
